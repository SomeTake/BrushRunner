//=============================================================================
//
// エフェクト管理マネージャ [EffectManager.cpp]
// Author : HAL東京 GP11B341 17 染谷武志
//
//=============================================================================
#include "Main.h"
#include "EffectManager.h"

static std::vector<Effect*> EffectVector;

//=====================================================================================================
// コンストラクタ
//=====================================================================================================
EffectManager::EffectManager()
{
	Effect::LoadTexture();
}

//=====================================================================================================
// デストラクタ
//=====================================================================================================
EffectManager::~EffectManager()
{
	for (auto &effect : EffectVector)
	{
		SAFE_DELETE(effect);
	}
	EffectVector.clear();
	ReleaseVector(EffectVector);

	Effect::ReleaseTexture();
}

//=====================================================================================================
// 更新
//=====================================================================================================
void EffectManager::Update()
{
	Check();

	for (auto &effect : EffectVector)
	{
		effect->Update();
	}
}

//=====================================================================================================
// 描画
//=====================================================================================================
void EffectManager::Draw()
{
	for (auto &effect : EffectVector)
	{
		effect->Draw();
	}
}

//=====================================================================================================
// 使用確認
//=====================================================================================================
void EffectManager::Check()
{
	for (auto effect = EffectVector.begin(); effect != EffectVector.end();)
	{
		if ((*effect)->GetUse() == false)
		{
			SAFE_DELETE((*effect));
			effect = EffectVector.erase(effect);
		}
		else
		{
			effect++;
		}
	}
}

//=====================================================================================================
// ゲッター
//=====================================================================================================
std::vector<Effect*> *GetEffectVector()
{ 
	return &EffectVector; 
}